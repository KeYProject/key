plugins {
    id 'application'
    id 'java-library'
    id 'com.gradleup.shadow' version "8.3.8"
}

def mainClasses = [
        removegenerics: 'de.uka.ilkd.key.util.removegenerics.Main',
        key           : "de.uka.ilkd.key.core.Main",
        pm            : "org.key_project.proofmanagement.Main",
        rifltrans     : "de.uka.ilkd.key.util.rifl.RIFLTransformer",
        "ci-tool"     : "io.github.wadoon.keycitool.CheckerKt",
]

mainClasses.each { name, mainClass ->
    def task = tasks.register("create${name.capitalize()}StartScripts", CreateStartScripts) {
        mainClassName = mainClass
        applicationName = name
        outputDir = file("$buildDir/scripts")
        classpath = sourceSets.main.runtimeClasspath
    }
    installDist.dependsOn(task)
}

repositories {
    mavenCentral()
    maven {
        url = uri("https://central.sonatype.com/repository/maven-snapshots/")
    }
}

dependencies {
    implementation(project(":key.ui"))
    implementation(project(":key.core.rifl"))
    implementation(project(":key.removegenerics"))
    implementation(project(":keyext.proofmanagement"))

    // third-party plugins
    runtimeOnly("io.github.wadoon.key:key-citool:1.7.0-SNAPSHOT") {
        exclude group: "org.key-project", module: ''
        exclude group: "org.slf4j", module: ''
    }
}


distributions {
    main {
        distributionBaseName = "key"
        contents {
            from("$rootDir/README.md")
            from("$rootDir/LICENSE.TXT")
        }
    }
}