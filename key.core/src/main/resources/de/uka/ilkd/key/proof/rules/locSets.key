/* This file is part of KeY - https://key-project.org
 * KeY is licensed under the GNU General Public License Version 2
 * SPDX-License-Identifier: GPL-2.0-only */

// This file contains the DECLARATIONS for location sets.
// Find the rules in file locSetRules.key

\sorts {
    LocSet;
}

\functions {
    // unique function symbols
    /*! The empty location set which does not contain any elements. */
    \unique LocSet empty;

    /*! The unique location set containing all locations, i.e. elementOf(o, f, allLocs)
        will always return true for an arbitrary Field f and Object o. */
    \unique LocSet allLocs;

    // other constructors
    /*! Converts a single location to a locations set with one element. */
    LocSet singleton(Object, Field);

    /*! Union between two location sets. */
    LocSet union(LocSet, LocSet);

    /*! Intersection between two location sets. */
    LocSet intersect(LocSet, LocSet);

    /*! Realizes relative complement (a.k.a. set difference) between two locations sets. It takes as arguments
        two location sets and returns another location set which contains all elements from the first argument
        except those that are elements of the second argument. */
    LocSet setMinus(LocSet, LocSet);

    /*! Takes as argument a term of type LocSet, which may contain a free variable. The term represents a family
        of locations sets, which is parameterized by the unbound variable. The returned location set is the union
        over all members of the parameterized family. */
    LocSet infiniteUnion {true}(LocSet);

    /*! The set that contains all locations which belong to the object o given as argument.

        A location (a,b) is in the set allFields(o) iff a=o.
        In JML, the function corresponds to `o.*`. */
    LocSet allFields(Object);

    /*! The set of all locations that belong to a particular field f given as argument.

        A location (a,b) is in the set allObjects(f) iff b=f. */
    LocSet allObjects(Field);

    /*! The set of locations which are fresh (that is not created) w.r.t. the heap h given as argument.
        A location (a,b) is in the set freshLocs(h) iff o.&lt;created&gt;@h = FALSE. */
    LocSet arrayRange(Object, int, int);

    LocSet freshLocs(Heap);
    // work-a-round
    LocSet allElementsOfArray(Heap, Object, LocSet);
    LocSet allElementsOfArrayLocsets(Heap, Object, LocSet);
}

\predicates {
    /*! This is the set theoretic membership predicate to be used for location sets.

        It takes three arguments: The first two (an Object and a Field) make up the location and the
        third is the location set against which membership is tested. */
    elementOf(Object, Field, LocSet);

    /*! This is the set theoretic subset predicate to be used for location sets.

        A location set A is subset of another location set B iff every element of A is also element of B.*/
    subset(LocSet, LocSet);

    /*! This binary predicate models disjointness of location sets.

        disjoint(A,B) is true iff A and B have an empty intersection,
        it is thus equivalent to intersect(A,B) = empty.*/
    disjoint(LocSet, LocSet);
    createdInHeap(LocSet, Heap);
}
